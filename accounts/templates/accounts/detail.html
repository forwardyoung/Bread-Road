{% extends 'base.html' %}
{% load django_bootstrap5 %}
{% block content %}
<!-- 제목 -->
<div class="container-sm  d-flex justify-content-between mt-4">
    <h1>{{ user.username }}님의 회원 정보페이지</h1>
    <!-- 회원정보 수정 버튼 -->

    {% if request.user == user %}
    <a href="{% url 'accounts:update' user.pk %}" class="btn btn-outline-success">회원정보 수정</a>
    {% endif%}
    <!-- 팔로우 버튼 -->
    {% if request.user != user %}
    <a href="{% url 'accounts:follow' user.pk %}">
        {% if request.user in user.followers.all %}
        <button class="btn btn-outline-danger mb-3">팔로우 취소</button>
        {% else %}
        <button class="btn btn-outline-success mb-3">팔로우</button>
        {% endif %}
    </a>
    {% endif %}
    <!-- 팔로워 팔로우 표시  -->
    <p>팔로우:
        {{ user.followings.count }}
        팔로워:
        {{ user.followers.count }}
    </p>

</div>


<!-- 회원 프로필  -->
<div class="container-xl d-flex m-4 align-items-center mr-auto" style="width: 20%;">
    {% if user.profile_set.all.count > 0 %}
    <img src="{{ profile_image.image.url }}" alt="" style="border-radius: 50%; width: 200px; height: 200px;">
    {% else %}
    <img class='w-100' src=" https://cdn-icons-png.flaticon.com/512/2769/2769140.png"
        style="border-radius: 50%; width: 200px; height: 200px;">
    {% endif %}
    <div class="container-xl mx-auto">
        <p>이름 : {{ user.first_name }} </p>
        <p>닉네임(아이디) : <br>{{ user.username }}</p>
        <p>최근 접속시간 : <br>{{ user.last_login }}</p>
        <p>이메일 : <br>{{ user.email }}</p>
        <p>성별:<br> {{ user.gender }}</p>
    </div>
</div>





<!-- 프로필 이미지 수정 -->
<div class="container-sm m-3">
    <p>프로필 이미지 수정</p>
    <form action="" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        {% bootstrap_form profile_form %}
        {% bootstrap_button button_type="submit" content="OK" %}
    </form>
</div>


<!-- 작성글 댓글 등등 보기 -->
<div class="container-sm flex-column ">
    <ul class="nav nav-tabs d-flex justify-content-between" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home-tab-pane"
                type="button" role="tab" aria-controls="home-tab-pane" aria-selected="true">작성한 글</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile-tab-pane"
                type="button" role="tab" aria-controls="profile-tab-pane" aria-selected="false">작성한 댓글</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact-tab-pane"
                type="button" role="tab" aria-controls="contact-tab-pane" aria-selected="false">좋아요 한 글</button>
        </li>
    </ul>

    <!-- 리뷰 작성한 글 -->
    <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="home-tab-pane" role="tabpanel" aria-labelledby="home-tab"
            tabindex="0">
            {% for review in user.review_set.all %}
            <div class='d-flex justify-content-between align-items-center'>
                <a href="{% url 'reviews:detail' user.pk %}">{{ review.content }}</a>
                <p>작성시간 : {{ review.created_at }}</p>
            </div>
            <br>
            {% endfor %}
        </div>
        <!-- 댓글  -->
        <div class="tab-pane fade" id="profile-tab-pane" role="tabpanel" aria-labelledby="profile-tab" tabindex="0">
            {% for comment in user.comment_set.all %}
            <div class='d-flex justify-content-between align-items-center'>
                <a href="{% url 'reviews:detail' comment.user_id %}">{{ comment.content }}</a>
                <p>작성시간 : {{ comment.created_at }}</p>
            </div>
            <br>
            {% endfor %}


        </div>
        <!-- 좋아요 한 글 -->
        <div class="tab-pane fade" id="contact-tab-pane" role="tabpanel" aria-labelledby="contact-tab" tabindex="0">
            {% for review in user.like_reviews.all %}
            <div class='d-flex justify-content-between align-items-center'>
                <a href="{% url 'reviews:detail' review.pk %}">{{ review.content }}</a>
            </div>
            <br>
            {% endfor %}
        </div>

    </div>
</div>
<!-- 회원정보 수정 탈퇴 -->
<div class="container-sm  d-flex justify-content-end m-5">
    <a href="{% url 'accounts:delete' %}" class="text-decoration-none btn btn-outline-danger mx-1">회원탈퇴</a>
</div>

{% endblock content %}